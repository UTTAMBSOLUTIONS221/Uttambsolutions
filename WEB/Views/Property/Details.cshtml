@model DBL.Models.PropertyHouseDetailData
@{
    ViewData["Title"] = "Details";
    Layout = "~/Views/Shared/_MasterLayout.cshtml";
}
<div class="container">
    @if (Model != null && Model.Data != null)
    {
        <div class="row">
            @foreach (var property in Model.Data)
            {
                <div class="col-lg-4 col-md-6 col-sm-12 mb-3">
                    <div class="card shadow-sm border-light" style="height: 100%; max-width: 350px;">
                        <img src="@Url.Content(property.Primaryimageurl ?? "~/images/house.png")" alt="@property.Propertyhousename" class="card-img-top" style="height: 180px; object-fit: cover;" />
                        <div class="card-body d-flex flex-column p-2">
                            <h6 class="card-title text-center text-dark" style="font-size: 1rem;">@property.Propertyhousename</h6>
                            <p class="card-text text-center text-muted mb-1" style="font-size: 0.9rem;">@property.Systemhousesizename</p>
                            <p class="card-text text-center text-muted mb-2" style="font-size: 0.9rem;">@property.Systempropertyhousesizename</p>
                            <div class="d-flex flex-wrap justify-content-center mb-2">
                                <span class="badge badge-primary mr-1"><strong>Rent:</strong> Kes. @property.Systempropertyhousesizerent.ToString("#,##0.00")</span>
                                @if (property.Systempropertyhousesizedeposit)
                                {
                                    <span class="badge badge-warning mr-1"><strong>Deposit:</strong> Kes. @property.Systempropertyhousesizerent.ToString("#,##0.00")</span>
                                }
                            </div>
                            <div class="d-flex flex-wrap justify-content-center mb-2">
                                <span class="badge badge-info mr-1"><strong>County:</strong> @property.Countyname</span>
                                <span class="badge badge-info mr-1"><strong>Sub County:</strong> @property.Subcountyname</span>
                            </div>
                            <div class="d-flex flex-wrap justify-content-center mb-2">
                                <span class="badge badge-info mr-1"><strong>Ward:</strong> @property.Subcountywardname</span>
                            </div>
                            <div class="d-flex flex-wrap justify-content-center mb-2">
                                <span class="badge badge-secondary mr-1"><strong>Landmark:</strong> @property.Streetorlandmark</span>
                            </div>
                            <div class="d-flex flex-wrap justify-content-center mb-2">
                                <span class="badge badge-success mr-1"><strong>Shop:</strong> @property.Propertyhouseshop</span>
                                <span class="badge badge-danger mr-1"><strong>Vacant:</strong> @property.Propertyhousevacant</span>
                                <span class="badge badge-warning"><strong>Renovation:</strong> @property.Propertyhouseunderrenovation</span>
                            </div>
                            @if (!property.Isvacant)
                            {
                                <a asp-action="Addpropertyhousetenant" asp-controller="Property" asp-route-Houseroomid="@property.Systempropertyhouseroomid" asp-area="" id="CAN_ADD_PROPERTY_HOUSE_TENANT" style="display:none;" class="btn-info btn-sm btn-custom text-white font-weight-bold text-uppercase text-center main" data-target="#Uttambsolutionsmodal" data-toggle="modal" data-backdrop="static" data-keyboard="false">Add Tenant</a>
                            }
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <div class="text-center my-5">
            <p class="text-muted">No property available at the moment.</p>
        </div>
    }
</div>
@section Scripts {
    <script type="text/javascript">
        function searchsystemstaffdata() {
            var idNumber = $('#Systemstaffidnumberid').val();
            // Validate if ID number input is empty
            if (idNumber.trim() === "") {
                $("#Systemstaffidnumberid").addClass('is-invalid');
                return;
            } else {
                $("#Systemstaffidnumberid").removeClass('is-invalid').addClass('is-valid');
            }

            $.ajax({
                url: '/Staff/Getsystemstaffdatabyidnumber',
                type: 'GET',
                data: { Idnumber: idNumber },
                success: function (response) {
                    var resultsContainer = $('#searchResults');
                    resultsContainer.empty();
                    if (response) {
                        var cardHtml =
                            '<input type="text" id="systemstaffid" value="' + response.Userid + '" class="form-control mb-2" hidden />' +
                            '<h5 class="card-title">Name: ' + response.Firstname + ' ' + response.Lastname + '</h5>' +
                            '<p class="card-text">ID Number: ' + response.Idnumber + '</p>' +
                            '<p class="card-text">Email Address: ' + response.Emailaddress + '</p>' +
                            '<p class="card-text">Phone Number: ' + response.Phonenumber + '</p>';

                        resultsContainer.append(cardHtml);
                    } else {
                        resultsContainer.append('<tr><td colspan="4" class="text-center">No results found.</td></tr>');
                    }

                    resultsContainer.removeClass('d-none');
                    $("#searchresultbuttons").removeClass('d-none');
                },
                error: function () {
                    alert('An error occurred while searching. Please try again.');
                }
            });
        }
    </script>
}